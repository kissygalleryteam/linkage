/*! linkage - v1.0 - 2013-08-28 8:42:12 PM
* Copyright (c) 2013 明河; Licensed  */
KISSY.add("gallery/linkage/1.0/index",function(a,b,c){function d(a){var b="click";if(!a.length)return b;var c=a.attr("type");if(!c){var d=a.getDOMNode().tagName;"SELECT"==d&&(c="select"),"TEXTAREA"==d&&(c="textarea")}switch(c){case"select":b="change";break;case"text":b="blur"}return b}function e(b,c){var d=this;c||(c={}),b&&a.mix(c,{target:b}),e.superclass.constructor.call(d,c)}var f="",g=b.all;return e.show=function(a,b){function c(){a.slideDown(.3)}return a.length&&b.length?"block"==a.css("display")?!1:"checkbox"==b.type?(b.prop("checkbox")&&c(),!0):(c(),void 0):!1},a.extend(e,c,{render:function(){var b=this,c=b.get("target");if(!c.length)return!1;var f=c.all(b.get("hook"));return f.length?(b.get("isHide")&&f.hide(),f.each(function(c){var f=c.attr("condition");if(!f)return!0;var h=f.split(":"),i=g(h[0]);h[1]||(h[1]=d(i));var j=g(h[0]);if(!j.length)return a.log(h[0]+"\u5143\u7d20\u4e0d\u5b58\u5728\uff01"),!0;var k=c.attr("action")||"show";i.on(h[1],function(d){a.isFunction(e[k])&&(e[k].call(b,c,i),b.fire("linkage",{target:c,srcNode:i,event:d.type}))})}),void 0):!1}},{ATTRS:{target:{value:f,getter:function(a){return g(a)}},hook:{value:".J_Linkage"},isHide:{value:!0}}}),e},{requires:["node","base","sizzle"]});